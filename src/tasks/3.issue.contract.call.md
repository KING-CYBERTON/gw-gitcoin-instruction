# 3. Issue a Smart Contract Call to the Deployed Smart Contract

In this task we will learn how to make function calls to the smart contract that was deployed in the previous task. We will provide some simple example code that uses the popular Web3.js library to do so. This code will allow you to interact with your smart contract which is running on Nervos' [Layer 2](../conceptual-explainers/structure.md#layer-1--layer-2) in a nearly identical way to if it was running on Ethereum.

Your smart contract should operate just like it would on Ethereum, but in actuality, it will be running in an EVM environment provided by [Polyjuice](../conceptual-explainers/frameworks.md#polyjuice). When combined with [Godwoken](../conceptual-explainers/frameworks.md#godwoken), which provides a Layer 2 solution with optimistic rollups, total throughput performance is significantly higher. This means that all users will experience dramatically lower fees, and more reliable transaction confirmation than if they were using Ethereum.

> Note: Before you complete the tasks, be sure to review the [Task Submission](#task-submission) section so you know what materials you will need to provide to judges to review your task submission.

## Prerequisites

Before you begin on this task you must complete the [first](1.create.godwoken.account.md) and [second](2.deploy.eth.contract.md) tasks. If you have not completed them, please do so now.

You will need the private key from the **Ethereum** address that you used in the last task. Make sure this is Ethereum private key for Layer 2, not the private key from your Nervos CKB Layer 1 address. If you do not have this, you can follow the instructions in [this tutorial](../component-tutorials/13.extract.ethereum.private.key.md), to extract your private key from MetaMask.

## 2. Clone and Setup the Gitcoin Task Instruction Examples

In this step you have to clone the Gitcoin Task Instructions examples repository, which contains the example code required by the tasks. The code we will be working with in this step will perform function calls to your smart contract. This uses the original version of Web3.js, with only a small difference in that it uses a custom Web3.js provider.

> Note: You may already have this repository available from the previous task. If so, you can reuse it, but make sure you use the proper directory as noted below.

Execute following commands to clone the Git repository and install the dependencies:

```sh
git clone https://github.com/kuzirashi/gw-gitcoin-instruction
cd gw-gitcoin-instruction/src/3-call-contract
yarn
```

## 4. Prepare the Smart Contract Address and ABI

To call a smart contract it needs to be deployed. Then you need to have its address and ABI. ABI is Application Binary Interface. It is used (among other things) as "decription" of what methods can be called on a smart contract. ABI is a result of compilation of smart contract. For popular smart contracts its also usually accessible by a quick web search or can be obtained from Etherscan for the Ethereum smart contracts.

If you don't have existing smart contract address and ABI then deploy your own smart contract. It's a straightforward process, trust us. There is complete tutorial how to do it in ["Deploy a simple Ethereum smart contract on Polyjuice"](./2.deploy.eth.contract.md) task tutorial. If you've used default SimpleStorage.sol contract then you should find ABI in `2-deploy-contract/build/contracts/SimpleStorage.json`. It is under "abi" property in the JSON. For the previously mentioned smart contract ABI is:

```json
[
    {
      "inputs": [],
      "stateMutability": "payable",
      "type": "constructor"
    },
    {
      "inputs": [
        {
          "internalType": "uint256",
          "name": "x",
          "type": "uint256"
        }
      ],
      "name": "set",
      "outputs": [],
      "stateMutability": "payable",
      "type": "function"
    },
    {
      "inputs": [],
      "name": "get",
      "outputs": [
        {
          "internalType": "uint256",
          "name": "",
          "type": "uint256"
        }
      ],
      "stateMutability": "view",
      "type": "function"
    }
]
```

If you haven't deployed your own smart contract then example deployed SimpleStorage address you can use on testnet is:

```txt
0xC46e27169824290EcaEf6E14503C1a6DE72d41B0
```

## 5. Prepare and Run a Script to Call the Smart Contract

A script logic that you're going to run is separated into two functions. First: `readCall()` will issue a read call to a smart contract. You do read calls when you want to just read the value from smart contract without changing its state. It's not sending a transaction, it will return a value from your smart contract function.

Second function is `writeCall()`, it will actually send a transaction. Write calls are usually used to change smart contract state. As a result of sending a transaction changing smart contract state you will only receive transaction receipt. You won't receive the return value from the smart contract. This behavior is the same as on Ethereum chain.

### Private Key

The example script that you're going to run already exists in `examples/3-call-contract/index.js`. First, change the Ethereum private key used to call smart contract in this file. Put there your Ethereum private key to the Ethereum account that you've deposited funds from Layer 1 to. Name of the variable to change is: `ACCOUNT_PRIVATE_KEY`. Make sure you put there your Ethereum private key, not your CKB private key:

```js
const ACCOUNT_PRIVATE_KEY = '<YOUR_PRIVATE_KEY>';
```

### ABI

Put ABI as value of the following variable:

```js
const CONTRACT_ABI = ['<YOUR_CONTRACT_ABI>']; // Array
```

> Note: Variable `CONTRACT_ABI` should be an Array, not a String.

### Contract address

Put contract address as value of the following variable:

```js
const CONTRACT_ADDRESS = '<YOUR_CONTRACT_ADDRESS>';
```

### Run script

When you've replaced all the variables above you're ready to call the script. Run following commands:

```sh
cd /src/examples/3-call-contract
yarn
node index.js
```

<details>
<summary>Example Output (click to expand)</summary>

```txt
âžœ node index.js 
Calling contract...
Read call result: 123
Write call transaction hash: 0x2a706f6cc50d4edc3e078920023872df82e03168992d2ea55308d441ab4933fb
Write call transaction receipt:  {
  transactionHash: '0x2a706f6cc50d4edc3e078920023872df82e03168992d2ea55308d441ab4933fb',
  blockHash: '0xe6287bea27e792e94833219ad3412068d1aebc235c8c8f5621a6db46e0ed1681',
  blockNumber: 20941,
  transactionIndex: 0,
  gasUsed: 20374,
  cumulativeGasUsed: 20374,
  logsBloom: '0x00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000',
  contractAddress: null,
  status: true,
  events: {}
}
Read call result: 888
```

</details>

If you've seen transaction hash and the transaction receipt then congratulations! You have successfully issued a smart contract write call on Nervos Layer 2.

## Task Submission

As a result of the contract call in the previous step, you should have received `Transaction hash` as part of the command output.

To complete the task, you will need to submit the following materials for review by the judges:

1. A screenshot of the console output immediately after you have successfully issued a smart contract call.
2. The `transaction hash` from the console output.
3. The contract address that you called, an its ABI.
